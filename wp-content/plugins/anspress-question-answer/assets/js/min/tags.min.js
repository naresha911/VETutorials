!function(a){"use strict";function b(a){a=a.replace(/^\s+|\s+$/g,""),a=a.toLowerCase();return a=a.replace(/\s+/g,"-").replace(/-+/g,"-")}function c(c,d){if(c=c.replace(/,/g,""),c=c.trim(),c=b(c),c.length>0){var e={element:"li",class:"ap-tagssugg-item",itemValueClass:"ap-tag-item-value",button:{class:"ap-tag-add",icon:"apicon-plus"},input:"",accessibilityText:apTagsTranslation.addTag};if(!d){var d="#ap-tags-holder";e.button.class="ap-tag-remove",e.button.icon="apicon-x",e.input='<input type="hidden" name="tags[]" value="'+c+'" />',e.accessibilityText=apTagsTranslation.deleteTag;var f=!1;if(a(d).find("."+e.class).find("."+e.itemValueClass).each(function(d,e){b(a(this).text())==c&&(f=a(this))}),f!==!1)return void f.animate({opacity:0},100,function(){f.animate({opacity:1},400)});a("#tags").is(":focus")||a("#tags").val("").focus(),a("#ap-tags-suggestion").hide(),setTimeout(function(){a("#ap-tags-aria-message").text(c+" "+apTagsTranslation.tagAdded)},250)}var g=a("<"+e.element+' class="'+e.class+'" title="'+e.accessibilityText+'"><button role="button" class="'+e.button.class+'"><span class="'+e.itemValueClass+'">'+c+'</span><i class="'+e.button.icon+'"></i></button>'+e.input+"</"+e.element+">");g.appendTo(d).fadeIn(300)}}function d(b){"undefined"!=typeof window.tagsquery&&window.tagsquery.abort(),window.tagsquery=jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"ap_tags_suggestion",q:b},context:this,dataType:"json",success:function(b){AnsPress.hideLoading(this),console.log(b),a("#ap-tags-suggestion").html(""),b.status&&(a("#ap-tags-suggestion").is(":visible")||a("#ap-tags-suggestion").show(),b.items&&a.each(b.items,function(b,d){d=decodeURIComponent(d);var e=[];a("#ap-tags-holder .ap-tag-item-value").each(function(){e.push(a(this).text())}),a.inArray(d,e)<0&&c(d,"#ap-tags-suggestion")}),setTimeout(function(){a("#ap-tags-aria-message").text(apTagsTranslation.suggestionsAvailable)},250))}})}a(document).ready(function(){a("#tags").on("apAddNewTag",function(b){b.preventDefault(),c(a(this).val().trim(",")),a(this).val("")}),a("#tags").on("keydown",function(b){if(13==b.keyCode)return b.preventDefault(),!1;if(38==b.keyCode||40==b.keyCode){var c=a("#ap-tags-suggestion").find(".ap-tag-add"),d=a("#ap-tags-suggestion").find(".focus"),e=c.index(d);e!=-1?(38==b.keyCode&&e--,40==b.keyCode&&e++):(38==b.keyCode&&(e=c.length-1),40==b.keyCode&&(e=0)),e>=c.length&&(e=-1),c.removeClass("focus"),e!=-1?(c.eq(e).addClass("focus"),a(this).val(c.eq(e).find(".ap-tag-item-value").text())):a(this).val(a(this).attr("data-original-value"))}}),a("#tags").on("keyup focus",function(b){b.preventDefault();var c=a(this).val().trim();clearTimeout(window.tagtime),9!=b.keyCode&&37!=b.keyCode&&38!=b.keyCode&&39!=b.keyCode&&40!=b.keyCode&&(13==b.keyCode||188==b.keyCode?(clearTimeout(window.tagtime),a(this).trigger("apAddNewTag")):(a(this).attr("data-original-value",a(this).val()),window.tagtime=setTimeout(function(){d(c)},200)))}),a("#ap-tags-suggestion").on("click",".ap-tagssugg-item",function(b){c(a(this).find(".ap-tag-item-value").text()),a(this).remove()}),a("body").on("click focusin",function(b){a("#ap-tags-suggestion").is(":visible")&&a(b.target).parents("#ap-tags-add").length<=0&&a("#ap-tags-suggestion").hide()}),a("body").on("click",".ap-tagssugg-item",function(b){var c=a(this).find(".ap-tag-item-value").text();setTimeout(function(){a("#ap-tags-aria-message").text(c+" "+apTagsTranslation.tagRemoved)},250),a(this).remove(),a("#ap-tags-list-title").focus()}),a("body").append('<div role="status" id="ap-tags-aria-message" aria-live="polite" aria-atomic="true" class="sr-only"></div>')})}(jQuery);
//# sourceMappingURL=tags.min.js.map